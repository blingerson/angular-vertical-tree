"use strict";var _extends=Object.assign||function(e){for(var r=1;r<arguments.length;r++){var t=arguments[r];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e};!function(){var e=window.angular||require("angular"),r=e.module("drg.angularVerticalTree",[]).directive("verticalTree",["$compile","$templateCache","$timeout",function(e,r,t){return{restrict:"EA",scope:{items:"<treeItems",treeOpts:"<",open:"&onOpen",select:"&onSelect"},controller:"vTreeCtrl",compile:function(n){var a=n.find("vertical-tree-breadcrumb"),l=n.find("vertical-tree-leaf");return a=a&&a.length>0?a.html():"",l=l&&l.length>0?l.html():"",n.empty(),{pre:function(t,n){t.templates={breadcrumb:"drg/vTreeBreadcrumb"+t.$id+".tpl.html",leaf:"drg/vTreeLeaf"+t.$id+".tpl.html"},r.put(t.templates.breadcrumb,a),r.put(t.templates.leaf,l),n.html(e(r.get("drg/angularVerticalTree.tpl.html"))(t))},post:function(e,r){e.updateBranchHeight=function(){t(function(){var e=r.children().eq(0),t=e.find(".v-tree-breadcrumb"),n=t.reduce(function(e,r){return e+$(r).outerHeight()},0);e.find(".v-tree-branch").css("height","calc(100% - "+n+"px)")})},e.updateBranchHeight()}}}}}]).controller("vTreeCtrl",["$scope",function(r){function t(r,n){return e.forEach(n,function(n,a){e.isObject(n)?r[a]?r[a]=t(e.isObject(r[a])?r[a]:{},n):r[a]=e.copy(n):r[a]=n}),r}function n(){return o.idProp?r.breadcrumbs.map(function(e){return e[o.idProp]}):[]}function a(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];if(l(),o.idProp)for(var t=u,n=0;n<e.length;n++){for(var a=!1,c=e[n],i=t[o.children],s=0;s<i.length;s++){var d=i[s];if(d[o.idProp]===c){r.breadcrumbs.push(d),t=d,a=!0;break}}if(!a)break}}function l(){r.breadcrumbs=[u]}function c(){var e=r.breadcrumbs[r.breadcrumbs.length-1];if(!e)return[];var t=e[r.opts.children];return t?t.filter(r.opts.isLeaf):[]}function i(e){r.breadcrumbs.push(e),r.leaves=c(),r.updateBranchHeight(),r.$emit("verticalTree.openFolder",e),r.open&&r.open({folder:e})}function s(e){r.$emit("verticalTree.selectItem",e),r.select&&r.select({item:e})}var o=r.opts=t({root:"Root",idProp:void 0,label:"label",children:"children",classes:{container:"panel panel-default",breadcrumb:"panel-heading",branch:"list-group",leaf:"list-group-item"},emptyMessage:"",isLeaf:function(){return!0},isFolder:function(e){return e[this.children]&&e[this.children].length>0}},r.treeOpts),u={};e.isObject(r.opts.root)?u=e.copy(r.opts.root):u[r.opts.label]=r.opts.root,_extends(r,{breadcrumbs:[],leaves:[],leafClickHandler:function(e){r.opts.isFolder(e)?i(e):r.opts.isLeaf(e)&&s(e)},breadcrumbClickHandler:function(e,t){r.breadcrumbs.splice(t,r.breadcrumbs.length-t),i(e)}}),l(),r.$watch("items",function(){u[o.children]=r.items,a(n())}),r.$watchCollection("breadcrumbs[ breadcrumbs.length - 1 ][ opts.children ]",function(){r.leaves=c()}),r.$on("vTree.setPath",function(e,r){return a(r)})}]);module&&(module.exports=r.name)}(),angular.module("drg.angularVerticalTree").run(["$templateCache",function(e){e.put("drg/angularVerticalTree.tpl.html",'<!-- .panel by default -->\n<div class="v-tree-container" ng-class="opts.classes.container">\n\n    <!-- .panel-heading by default -->\n    <a class="v-tree-breadcrumb"\n       href="javascript:;"\n       ng-class="opts.classes.breadcrumb"\n       ng-click="breadcrumbClickHandler( breadcrumb, $index )"\n       ng-include="templates.breadcrumb"\n       ng-repeat="breadcrumb in breadcrumbs track by ( opts.idProp ? breadcrumb[ opts.idProp ] : $index )"\n       style="display: block;">\n    </a>\n\n    <!-- .list-group by default -->\n    <div class="v-tree-branch" ng-class="opts.classes.branch">\n        <!-- .list-group-item by default -->\n        <a class="v-tree-leaf"\n           href="javascript:;"\n           ng-class="opts.classes.leaf"\n           ng-click="leafClickHandler( leaf )"\n           ng-include="templates.leaf"\n           ng-repeat="leaf in leaves track by ( opts.idProp ? leaf[ opts.idProp ] : $index )">\n        </a>\n        <p class="v-tree-empty" ng-if="!leaves || !leaves.length" ng-bind="opts.emptyMessage"></p>\n    </div>\n\n</div>\n')}]);